<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema M√©dico</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #212529;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: #121212;
            color: #ffffff;
        }

        .navbar {
            background-color: #00796b;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .navbar.dark-mode {
            background-color: #004d40;
        }

        .container {
            margin-top: 3rem;
        }

        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s, color 0.3s;
        }

        .card.dark-mode {
            background-color: #1e272e;
            color: #ffffff;
        }
        .card-body.dark-mode {
            background-color: #3b3f43;
            color: #ffffff;
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s, color 0.3s;
        }

        .btn-primary {
            background-color: #00796b;
            border: none;
        }

        .btn-primary:hover {
            background-color: #004d40;
        }

        .btn-primary.dark-mode {
            background-color: #37474f;
        }

        .btn-primary.dark-mode:hover {
            background-color: #455a64;
        }

        .btn-danger {
            background-color: #d32f2f;
            border: none;
        }

        .btn-danger:hover {
            background-color: #b71c1c;
        }

        .hero-section {
            background: linear-gradient(135deg, #00796b, #004d40);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .hero-section h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .hero-section p {
            font-size: 1.2rem;
        }

        .footer {
            margin-top: 10rem;
            text-align: center;
            padding: 1rem;
            background-color: #00796b;
            color: white;
            border-radius: 10px;
        }

        .footer.dark-mode {
            background-color: #004d40;
        }

        /* Estilos para los botones de configuraci√≥n */
        .config-buttons {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .config-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
            color: white;
        }

        .config-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- Botones de configuraci√≥n -->
    <div class="config-buttons">
        <button id="languageToggle" class="config-btn" title="Cambiar idioma">üá∫üá∏</button>
        <button id="themeToggle" class="config-btn" title="Cambiar tema">üåô</button>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#" data-i18n="medical_system">Sistema M√©dico</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item position-relative" style="margin-top: 10px;">
                        <a href="/notificaciones" class="btn btn-primary btn-sm d-flex align-items-center gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bell" viewBox="0 0 16 16">
                                <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2M8 1.918l-.797.161A4 4 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4 4 0 0 0-3.203-3.92zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5 5 0 0 1 13 6c0 .88.32 4.2 1.22 6"/>
                            </svg>
                            <span data-i18n="notifications">Notificaciones</span>
                        </a>
                        <span id="notificationCount" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none;">
                            0
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="container">
        <div class="hero-section">
            <h1 data-i18n="welcome_medical_system">Bienvenido al Sistema M√©dico</h1>
            <p data-i18n="manage_appointments">Gestiona tus citas, calendario y perfil de manera eficiente.</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="card p-4 text-center">
            <h2 class="mb-4"><span data-i18n="hello">Hola</span>, <span th:text="${nombreUsuario}" style="color: #00796b;">Paciente</span></h2>
            <p class="mb-4" style="font-size: 1.2rem;" data-i18n="select_option">Selecciona una opci√≥n para continuar:</p>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title" data-i18n="appointments">Citas</h5>
                            <p class="card-text" data-i18n="manage_appointments_desc">Consulta y gestiona tus citas m√©dicas f√°cilmente.</p>
                            <a href="/citas" class="btn btn-primary" data-i18n="go_to_appointments">Ir a Citas</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title" data-i18n="calendar">Calendario</h5>
                            <p class="card-text" data-i18n="calendar_desc">Visualiza tus citas en un calendario interactivo.</p>
                            <a href="/calendario" class="btn btn-primary" data-i18n="go_to_calendar">Ir al Calendario</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title" data-i18n="my_profile">Mi Perfil</h5>
                            <p class="card-text" data-i18n="profile_desc">Actualiza tu informaci√≥n personal y m√©dica.</p>
                            <a href="/perfil" class="btn btn-primary" data-i18n="go_to_profile">Ir a Mi Perfil</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title" data-i18n="consultations">Consultas</h5>
                            <p class="card-text" data-i18n="consultations_desc">Revisa tus consultas m√©dicas y su historial.</p>
                            <a href="/consultas" class="btn btn-primary" data-i18n="go_to_consultations">Ir a Consultas</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title" data-i18n="chat">Chat</h5>
                            <p class="card-text" data-i18n="chat_desc">Comun√≠cate con tu m√©dico de manera directa.</p>
                            <a href="/chat" class="btn btn-primary" data-i18n="go_to_chat">Ir al Chat</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4" th:if="${isAdmin}">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title" data-i18n="administrator">Administrador</h5>
                            <p class="card-text" data-i18n="admin_desc">Gestiona usuarios y configuraciones del sistema.</p>
                            <a href="/admin" class="btn btn-primary" data-i18n="go_to_admin">Ir al Administrador</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-4">
                <a href="/logout" class="btn btn-danger" data-i18n="logout">Cerrar Sesi√≥n</a>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer">
            <p data-i18n="copyright">&copy; 2025 Sistema M√©dico. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script de idiomas embebido -->
    <script>
        const languages = {
            es: {
                "medical_system": "Sistema M√©dico",
                "notifications": "Notificaciones",
                "welcome_medical_system": "Bienvenido al Sistema M√©dico",
                "manage_appointments": "Gestiona tus citas, calendario y perfil de manera eficiente.",
                "hello": "Hola",
                "select_option": "Selecciona una opci√≥n para continuar:",
                "appointments": "Citas",
                "manage_appointments_desc": "Consulta y gestiona tus citas m√©dicas f√°cilmente.",
                "go_to_appointments": "Ir a Citas",
                "calendar": "Calendario",
                "calendar_desc": "Visualiza tus citas en un calendario interactivo.",
                "go_to_calendar": "Ir al Calendario",
                "my_profile": "Mi Perfil",
                "profile_desc": "Actualiza tu informaci√≥n personal y m√©dica.",
                "go_to_profile": "Ir a Mi Perfil",
                "consultations": "Consultas",
                "consultations_desc": "Revisa tus consultas m√©dicas y su historial.",
                "go_to_consultations": "Ir a Consultas",
                "chat": "Chat",
                "chat_desc": "Comun√≠cate con tu m√©dico de manera directa.",
                "go_to_chat": "Ir al Chat",
                "administrator": "Administrador",
                "admin_desc": "Gestiona usuarios y configuraciones del sistema.",
                "go_to_admin": "Ir al Administrador",
                "logout": "Cerrar Sesi√≥n",
                "copyright": "¬© 2025 Sistema M√©dico. Todos los derechos reservados."
            },
            en: {
                "medical_system": "Medical System",
                "notifications": "Notifications",
                "welcome_medical_system": "Welcome to Medical System",
                "manage_appointments": "Manage your appointments, calendar and profile efficiently.",
                "hello": "Hello",
                "select_option": "Select an option to continue:",
                "appointments": "Appointments",
                "manage_appointments_desc": "View and manage your medical appointments easily.",
                "go_to_appointments": "Go to Appointments",
                "calendar": "Calendar",
                "calendar_desc": "View your appointments in an interactive calendar.",
                "go_to_calendar": "Go to Calendar",
                "my_profile": "My Profile",
                "profile_desc": "Update your personal and medical information.",
                "go_to_profile": "Go to My Profile",
                "consultations": "Consultations",
                "consultations_desc": "Review your medical consultations and history.",
                "go_to_consultations": "Go to Consultations",
                "chat": "Chat",
                "chat_desc": "Communicate with your doctor directly.",
                "go_to_chat": "Go to Chat",
                "administrator": "Administrator",
                "admin_desc": "Manage users and system settings.",
                "go_to_admin": "Go to Administrator",
                "logout": "Logout",
                "copyright": "¬© 2025 Medical System. All rights reserved."
            }
        };

        // Gestor de internacionalizaci√≥n
        class I18nManager {
            constructor() {
                this.currentLanguage = localStorage.getItem('language') || 'es';
                this.loadLanguage();
            }

            loadLanguage() {
                this.updateTexts();
                this.updateLanguageToggle();
            }

            toggleLanguage() {
                this.currentLanguage = this.currentLanguage === 'es' ? 'en' : 'es';
                localStorage.setItem('language', this.currentLanguage);
                this.updateTexts();
                this.updateLanguageToggle();
            }

            updateTexts() {
                const texts = languages[this.currentLanguage];
                
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    if (texts[key]) {
                        element.textContent = texts[key];
                    }
                });

                document.title = this.currentLanguage === 'es' ? 'Sistema M√©dico' : 'Medical System';
            }

            updateLanguageToggle() {
                const languageToggle = document.getElementById('languageToggle');
                if (languageToggle) {
                    languageToggle.textContent = this.currentLanguage === 'es' ? 'üá∫üá∏' : 'üá™üá∏';
                    languageToggle.title = this.currentLanguage === 'es' ? 'English' : 'Espa√±ol';
                }
            }
        }

        // Modo oscuro
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
    
        if (localStorage.getItem('darkMode') === 'enabled') {
            body.classList.add('dark-mode');
            themeToggle.textContent = '‚òÄÔ∏è';
            document.querySelector('.navbar').classList.add('dark-mode');
            document.querySelector('.footer').classList.add('dark-mode');
            document.querySelector('.card').classList.add('dark-mode');
            document.querySelectorAll('.card-body').forEach(card => card.classList.add('dark-mode'));
        }
    
        themeToggle.addEventListener('click', () => {
            const isDarkMode = body.classList.toggle('dark-mode');
            themeToggle.textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
            document.querySelector('.navbar').classList.toggle('dark-mode');
            document.querySelector('.footer').classList.toggle('dark-mode');
            document.querySelector('.card').classList.toggle('dark-mode');
            document.querySelectorAll('.card-body').forEach(card => {
                if (isDarkMode) {
                    card.classList.add('dark-mode');
                } else {
                    card.classList.remove('dark-mode');
                }
            });
            localStorage.setItem('darkMode', isDarkMode ? 'enabled' : 'disabled');
        });

        // Inicializar sistema de idiomas
        const i18n = new I18nManager();
        document.getElementById('languageToggle').addEventListener('click', () => {
            i18n.toggleLanguage();
        });

        // Script de notificaciones (mantener funcionalidad existente)
        document.addEventListener('DOMContentLoaded', function () {
            function actualizarContadorNotificaciones() {
                fetch('/notificaciones/nuevas')
                    .then(response => response.json())
                    .then(data => {
                        const notificationCount = document.getElementById('notificationCount');
                        if (data.nuevas > 0) {
                            notificationCount.textContent = data.nuevas;
                            notificationCount.style.display = 'inline';
                        } else {
                            notificationCount.style.display = 'none';
                        }
                    })
                    .catch(error => console.error('Error al obtener notificaciones:', error));
            }
    
            actualizarContadorNotificaciones();
            setInterval(actualizarContadorNotificaciones, 30000);
        });
    </script>
</body>
</html>